Ink.createModule("Ink.UI.Spy","1",["Ink.UI.Common_1","Ink.Dom.Event_1","Ink.Dom.Css_1","Ink.Dom.Element_1","Ink.Dom.Selector_1"],function(n,t,e,o,i){"use strict";function r(n){for(var t=0,e=f.length;e>t;t++)if(f[t][0]===n)return t;return null}function a(n,t,e){var o=r(t);null===o?f.push([t,[n],e]):f[o][1].push(n)}function l(){p||(p=!0,t.observe(document,"scroll",t.throttle(u,300)))}function u(){for(var n=0,t=f.length;t>n;n++)s(f[n][0],f[n][1],f[n][2])}function s(n,t,r){for(var a=m(t,r),l=i.select("li.active",n),u=0,s=l.length;s>u;u++)e.removeClassName(l[u],"active");if(null!==a){var c='a[href$="#'+(a.name||a.id)+'"]',f=i.select(c,n);for(u=0,s=f.length;s>u;u++)e.addClassName(o.findUpwardsByTag(f[u],"li"),"active")}}function m(n,t){for(var e,o,i=-(1/0),r=0,a=n.length;a>r;r++)o=n[r].getBoundingClientRect().top,t.margin&&(o-=t.margin),0>=o&&o>i&&(i=o,e=r);return void 0===e?null:n[e]}function c(){n.BaseUIComponent.apply(this,arguments)}var f=[],p=!1;return c._name="Spy_1",c._optionDefinition={target:["Element",void 0],margin:["Number",0]},c.prototype={_init:function(){a(this._element,this._options.target,this._options),l(),u()}},n.createUIComponent(c),c});